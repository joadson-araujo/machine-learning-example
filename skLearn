## Ciência de Dados
## Exemplo de Treino x Teste oriundos para criação de Modelo Machine Learning usando a Biblioteca ExtraTreesClassifier do SKLEARN

#coluna target (alvo) será a style
dados = pd.read_csv('wine_dataset.csv')

dados.describe()

#pre-processamento

dados['style'] = dados['style'].replace('red', 0)
dados['style'] = dados['style'].replace('white', 1)

#separar variaveis preditoras do alvo
x = dados.drop('style', axis=1) #axis 1 colunas
y = dados['style']

# 70% x 30%
from sklearn.model_selection import train_test_split

#para o x, separou 70%, para o y, 30%
x_treino, x_teste, y_treino, y_teste = train_test_split(x,y,test_size=0.3)

from sklearn.ensemble import ExtraTreesClassifier

modelo = ExtraTreesClassifier()

modelo.fit(x_treino, y_treino) #treina os dados (metodo supervisionado)

#validacao dos resultados
acuracia = modelo.score(x_teste, y_teste)
acuracia

#previsao
previsao = modelo.predict(x_teste) #pega novos dados e joga dentro do modelo treinado
previsao

#matriz de confusao
from sklearn.metrics import confusion_matrix
mc = confusion_matrix(y_teste, previsao)
mc

